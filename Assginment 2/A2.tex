\documentclass{article}

% Import necessary packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{braket}
% Set page margins
\usepackage[margin=1in]{geometry}

% Set code block style
\lstset{
    basicstyle=\ttfamily,
    keywordstyle=\color{blue},
    commentstyle=\color{gray},
    stringstyle=\color{purple},
    showstringspaces=false,
    breaklines=true,
    breakatwhitespace=true,
    captionpos=b,
    frame=single,
    numbers=left,
    numbersep=5pt,
    numberstyle=\tiny\color{gray},
    backgroundcolor=\color{lightgray!20},
    rulecolor=\color{black},
    tabsize=4
}

% Set title and author
\title{Assignment 2}
\author{Wang Dingrui}

\begin{document}

\maketitle

\section{EXERCISE 1: THE PARTIAL TRACE}

We saw in the lectures that given a multi-partite state, we obtain the state of a subsystem by applying the partial trace to the other systems.

\begin{enumerate}
    \item Compute the trace of the following states by applying the trace formula $ Tr(A)=\sum_i\bra{i}A\ket{i} $ from the lectures:
          \begin{enumerate}
              \item $\xi = \frac{1}{2}(\ket{0}\bra{0} - i\ket{0}\bra{1} + i\ket{1}\bra{0} + \ket{1}\bra{1})$
              \item $\Lambda = \frac{I}{3}I + \frac{1}{6}(\ket{0}\bra{1} + \ket{1}\bra{0})$ (here, $I$ is the identity matrix).

                    Which of the states is normalized correctly? (*) (4 points)
          \end{enumerate}
          Answer: $\xi = \frac{1}{2}(\ket{0}\bra{0} - i\ket{0}\bra{1} + i\ket{1}\bra{0} + \ket{1}\bra{1})
              \\= \frac{1}{2}(\begin{bmatrix}
                  1 & 0 \\
                  0 & 0
              \end{bmatrix} - i\begin{bmatrix}
                  0 & 1 \\
                  0 & 0
              \end{bmatrix} + i\begin{bmatrix}
                  0 & 0 \\
                  1 & 0
              \end{bmatrix} + \begin{bmatrix}
                  0 & 0 \\
                  0 & 1
              \end{bmatrix})
              \\= \frac{1}{2}(\begin{bmatrix}
                  1 & -i \\
                  i & 1
              \end{bmatrix})
              \\= \begin{bmatrix}
                  \frac{1}{2} & -\frac{i}{2} \\
                  \frac{i}{2} & \frac{1}{2}
              \end{bmatrix}$

          $Tr(\xi) = \ket{0}\xi\bra{0}+\ket{1}\xi\bra{1}
              \\= \begin{bmatrix}
                  1 & 0
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{2} & -\frac{i}{2} \\
                  \frac{i}{2} & \frac{1}{2}
              \end{bmatrix}\begin{bmatrix}
                  1 \\
                  0
              \end{bmatrix}+\begin{bmatrix}
                  0 & 1
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{2} & -\frac{i}{2} \\
                  \frac{i}{2} & \frac{1}{2}
              \end{bmatrix}\begin{bmatrix}
                  0 \\
                  1
              \end{bmatrix}
              \\= \begin{bmatrix}
                  1 & 0
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{2} \\
                  \frac{i}{2}
              \end{bmatrix}+\begin{bmatrix}
                  0 & 1
              \end{bmatrix}\begin{bmatrix}
                  -\frac{i}{2} \\
                  \frac{1}{2}
              \end{bmatrix}
              \\= \frac{1}{2}+\frac{1}{2}
              \\= 1$

          $\Lambda = \frac{I}{3}I + \frac{1}{6}(\ket{0}\bra{1} + \ket{1}\bra{0})
              \\=\frac{I}{3}+\frac{1}{6}(\begin{bmatrix}
                  1 & 0 \\
              \end{bmatrix}\begin{bmatrix}
                  0 \\
                  1
              \end{bmatrix}+\begin{bmatrix}
                  0 & 1
              \end{bmatrix}\begin{bmatrix}
                  1 \\
                  0
              \end{bmatrix})
              \\=\frac{I}{3}+\frac{1}{6}(\begin{bmatrix}
                  0 & 0 \\
                  1 & 0
              \end{bmatrix}+\begin{bmatrix}
                  0 & 1 \\
                  0 & 0
              \end{bmatrix})
              \\=\frac{I}{3}+\frac{1}{6}(\begin{bmatrix}
                  0 & 1 \\
                  1 & 0
              \end{bmatrix})
              \\=\begin{bmatrix}
                  0           & \frac{1}{3} \\
                  \frac{1}{3} & 0
              \end{bmatrix}+\begin{bmatrix}
                  0           & \frac{1}{6} \\
                  \frac{1}{6} & 0
              \end{bmatrix}
              \\=\begin{bmatrix}
                  \frac{1}{3} & \frac{1}{6} \\
                  \frac{1}{6} & \frac{1}{3}
              \end{bmatrix}$


          $Tr(\Lambda) = \ket{0}\Lambda\bra{0}+\ket{1}\Lambda\bra{1}
              \\= \begin{bmatrix}
                  1 & 0
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{3} & \frac{1}{6} \\
                  \frac{1}{6} & \frac{1}{3}
              \end{bmatrix}\begin{bmatrix}
                  1 \\
                  0
              \end{bmatrix}+\begin{bmatrix}
                  0 & 1
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{3} & \frac{1}{6} \\
                  \frac{1}{6} & \frac{1}{3}
              \end{bmatrix}\begin{bmatrix}
                  0 \\
                  1
              \end{bmatrix}
              \\= \begin{bmatrix}
                  1 & 0
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{3} \\
                  \frac{1}{6}
              \end{bmatrix}+\begin{bmatrix}
                  0 & 1
              \end{bmatrix}\begin{bmatrix}
                  \frac{1}{6} \\
                  \frac{1}{3}
              \end{bmatrix}
              \\= \frac{1}{3}+\frac{1}{3}
              \\= \frac{2}{3}$

          So $\xi$ is normalized correctly.


    \item In the last assignment we found the probability to find a state $\ket{\gamma}$ in another state $\ket{\delta}$ to be $p = |\braket{\gamma|\delta}|^2$. Show here that this expression coincides with $\mathrm{Tr}(\gamma\delta)$, for $\gamma = \ket{\gamma}\bra{\gamma}$ and $\delta = \ket{\delta}\bra{\delta}$. Hint: Apply the trace formula $\mathrm{Tr}(A) = \sum_i \braket{i|A|i}$ from the lectures. Use a suitable basis of your choice. (4 points)

          Answer: $\mathrm{Tr}(\gamma\delta)
              \\= \mathrm{Tr}(\ket{\gamma}\bra{\gamma}\ket{\delta}\bra{\delta})
              \\= \mathrm{Tr}(\ket{\gamma}\braket{\gamma|\delta}\bra{\delta})
              \\= \mathrm{Tr}(\braket{\gamma|\delta}\ket{\gamma}\bra{\delta})
              \\= \braket{\gamma|\delta}\mathrm{Tr}(\ket{\gamma}\bra{\delta})
              \\= \braket{\gamma|\delta}\sum_i\braket{i|\ket{\gamma}\bra{\delta}|i}
              \\= \braket{\gamma|\delta}(\bra{0}\ket{\gamma}\bra{\delta}\ket{0}+\bra{1}\ket{\gamma}\bra{\delta}\ket{1})
              \\= \braket{\gamma|\delta}(\braket{0|\gamma}\braket{\delta|0}+\braket{1|\gamma}\braket{\delta|1})
              \\= \braket{\gamma|\delta}(\braket{\gamma|0}\braket{0|\delta}+\braket{\gamma|1}\braket{1|\delta})
              \\= \braket{\gamma|\delta}(\braket{\gamma|\delta})
              \\= |\braket{\gamma|\delta}|^2$

          So, $\mathrm{Tr}(\gamma\delta) = |\braket{\gamma|\delta}|^2 = p$.

    \item Consider the bipartite state $\ket{\phi}_{AB} = \frac{1}{\sqrt{3}}(\ket{00}_{AB} + i\ket{01}_{AB} - \ket{11}_{AB})$. Write the density operator $\rho_{AB} = \ket{\phi}_{AB}\bra{\phi}_{AB}$ explicitly in matrix form. (*) (4 points)

          Answer:
          $\rho_{AB}
              \\= \ket{\phi}_{AB}\bra{\phi}_{AB}
              \\= \frac{1}{\sqrt{3}}(\ket{00}_{AB} + i\ket{01}_{AB} - \ket{11}_{AB})(\bra{00}_{AB} - i\bra{01}_{AB} - \bra{11}_{AB})
              \\= \frac{1}{3}(\ket{00}\bra{00}-i\ket{00}\bra{01}-\ket{00}\bra{11}+i\ket{01}\bra{00}+\ket{01}\bra{01}+\ket{01}\bra{11}-\ket{11}\bra{00}-\ket{11}\bra{01}+\ket{11}\bra{11})
              \\= \frac{1}{3}(\begin{bmatrix}
                  1 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
              \end{bmatrix}
              -i\begin{bmatrix}
                  0 & 0 & 0 & 0 \\
                  1 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
              \end{bmatrix}
              -\begin{bmatrix}
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  1 & 0 & 0 & 0 \\
              \end{bmatrix}
              +i\begin{bmatrix}
                  0 & 1 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
              \end{bmatrix}
              +\begin{bmatrix}
                  0 & 0 & 0 & 0 \\
                  0 & 1 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
              \end{bmatrix}
              +\begin{bmatrix}
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 1 & 0 & 0 \\
              \end{bmatrix}
              -\begin{bmatrix}
                  0 & 0 & 0 & 1 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
              \end{bmatrix}
              +\begin{bmatrix}
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 1 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
              \end{bmatrix}
              -\begin{bmatrix}
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 0 \\
                  0 & 0 & 0 & 1 \\
              \end{bmatrix}
              )
              \\=\frac{1}{3}\begin{bmatrix}
                  1  & i & 0 & -1 \\
                  -i & 1 & 0 & 1  \\
                  0  & 0 & 0 & 0  \\
                  -1 & i & 0 & 1  \\
              \end{bmatrix}
              \\=\begin{bmatrix}
                  \frac{1}{3}  & \frac{i}{3} & 0 & -\frac{1}{3} \\
                  -\frac{i}{3} & \frac{1}{3} & 0 & \frac{1}{3}  \\
                  0            & 0           & 0 & 0            \\
                  -\frac{1}{3} & \frac{i}{3} & 0 & \frac{1}{3}  \\
              \end{bmatrix}
          $
    \item Let $\sigma_{AB}$ be a general 2-qubit state. The $4\times4$ matrix describing $\sigma_{AB}$ can be split into four sub-matrices of size $2\times2$ (upper left block, upper right block, lower left block, lower right block). Show that the reduced single qubit state $\sigma_B = \mathrm{Tr}_A(\sigma_{AB})$ is described by a $2\times2$ matrix that is the sum of the upper left block and lower right block matrices of $\sigma_{AB}$. Hint: start from $\sigma_{AB} = \sigma_{00}|00\rangle\langle00| + \sigma_{01}|00\rangle\langle01| + ... + \sigma_{33}|11\rangle\langle11|$ and compute the partial trace in bra-ket notation. Write $\sigma_{AB}$ as a matrix and compare. (8 points)

          Answer: $\sigma_{AB} = \sigma_{00}\ket{00}\bra{00} + \sigma_{01}\ket{00}\bra{01} + ... + \sigma_{33}\ket{11}\bra{11}$


          $\sigma_B =
              \\=\mathrm{Tr}_A(\sigma_{AB})
              \\= \sum_i\bra{i}\sigma_{AB}\ket{i}
              \\= \bra{0}\sigma_{AB}\ket{0}+\bra{1}\sigma_{AB}\ket{1}
              \\= \bra{0}(\sigma_{00}\ket{00}\bra{00} + \sigma_{01}\ket{00}\bra{01} + ... + \sigma_{33}\ket{11}\bra{11})\ket{0}+\bra{1}(\sigma_{00}\ket{00}\bra{00} + \sigma_{01}\ket{00}\bra{01} + ... + \sigma_{33}\ket{11}\bra{11})\ket{1}
              \\=
              \sigma_{00}\braket{0|00}\braket{00|0}+
              \sigma_{01}\braket{0|00}\braket{01|0}+
              \sigma_{02}\braket{0|00}\braket{10|0}+
              \sigma_{03}\braket{0|00}\braket{11|0}+
              \sigma_{10}\braket{0|01}\braket{00|0}+
              \sigma_{11}\braket{0|01}\braket{01|0}+
              \sigma_{12}\braket{0|01}\braket{10|0}+
              \sigma_{13}\braket{0|01}\braket{11|0}+
              \sigma_{20}\braket{0|10}\braket{00|0}+
              \sigma_{21}\braket{0|10}\braket{01|0}+
              \sigma_{22}\braket{0|10}\braket{10|0}+
              \sigma_{23}\braket{0|10}\braket{11|0}+
              \sigma_{30}\braket{0|11}\braket{00|0}+
              \sigma_{31}\braket{0|11}\braket{01|0}+
              \sigma_{32}\braket{0|11}\braket{10|0}+
              \sigma_{33}\braket{0|11}\braket{11|0}+
              \sigma_{00}\braket{1|00}\braket{00|1}+
              \sigma_{01}\braket{1|00}\braket{01|1}+
              \sigma_{02}\braket{1|00}\braket{10|1}+
              \sigma_{03}\braket{1|00}\braket{11|1}+
              \sigma_{10}\braket{1|01}\braket{00|1}+
              \sigma_{11}\braket{1|01}\braket{01|1}+
              \sigma_{12}\braket{1|01}\braket{10|1}+
              \sigma_{13}\braket{1|01}\braket{11|1}+
              \sigma_{20}\braket{1|10}\braket{00|1}+
              \sigma_{21}\braket{1|10}\braket{01|1}+
              \sigma_{22}\braket{1|10}\braket{10|1}+
              \sigma_{23}\braket{1|10}\braket{11|1}+
              \sigma_{30}\braket{1|11}\braket{00|1}+
              \sigma_{31}\braket{1|11}\braket{01|1}+
              \sigma_{32}\braket{1|11}\braket{10|1}+
              \sigma_{33}\braket{1|11}\braket{11|1}
              \\=
              \sigma_{00}\ket{0}\bra{0}+\sigma_{02}\ket{0}\bra{1}+\sigma_{10}\ket{1}\bra{0}+\sigma_{12}\ket{1}\bra{1}+\sigma_{21}\ket{0}\bra{0}+\sigma_{23}\ket{0}\bra{1}+\sigma_{31}\ket{1}\bra{0}+\sigma_{33}\ket{1}\bra{1}
              \\=(\sigma_{00}+\sigma_{21})\ket{0}\bra{0}+(\sigma_{02}+\sigma_{23})\ket{0}\bra{1}+(\sigma_{10}+\sigma_{31})\ket{1}\bra{0}+(\sigma_{12}+\sigma_{33})\ket{1}\bra{1}
          $

          This is the sum of the upper left block and lower right block matrices of $\sigma_{AB}$.

    \item Take the state $\rho_{AB}$ from 3. and compute the reduced state $\rho_B$, both from the matrix itself (using your result from 4.) and in bra-ket notation. (*) (6 points)

          Answer: $\rho_{AB} = \begin{bmatrix}
                  \frac{1}{3}  & \frac{i}{3} & 0 & -\frac{1}{3} \\
                  -\frac{i}{3} & \frac{1}{3} & 0 & \frac{1}{3}  \\
                  0            & 0           & 0 & 0            \\
                  -\frac{1}{3} & \frac{i}{3} & 0 & \frac{1}{3}  \\
              \end{bmatrix}$

          $\rho_B = (\rho_{00}+\rho_{21})\ket{0}\bra{0}+(\rho_{02}+\rho_{23})\ket{0}\bra{1}+(\rho_{10}+\rho_{31})\ket{1}\bra{0}+(\rho_{12}+\rho_{33})\ket{1}\bra{1}
              \\= (\frac{1}{3}+0)\ket{0}\bra{0}+(0+0)\ket{0}\bra{1}+(-\frac{i}{3}+\frac{i}{3})\ket{1}\bra{0}+(\frac{1}{3}+\frac{1}{3})\ket{1}\bra{1}
              \\= \frac{1}{3}\ket{0}\bra{0}+0\ket{0}\bra{1}+0\ket{1}\bra{0}+\frac{2}{3}\ket{1}\bra{1}
              \\= \begin{bmatrix}
                  \frac{1}{3} & 0           \\
                  0           & \frac{2}{3} \\
              \end{bmatrix}$
\end{enumerate}

\section{EXERCISE 2: MEASUREMENTS AND REDUCED STATES}
Let us look at the density operator $\rho_{AB} = |\Phi^{-}\rangle\langle\Phi^{-}|$, with $|\Phi^{-}\rangle = \frac{1}{\sqrt{2}}(\bra{01} - \bra{10})$.

\begin{enumerate}
    \item Compute explicitly the post-measurement state after we performed a projective measurement $M = \{\ket{0}\bra{0},\ket{1}\bra{1}\}$ on $\rho_{AB}$ on system $B$, given that the outcome was $0$. Compute the same for the measurement $M = \{|+\rangle\langle+|, |-\rangle\langle-|\}$, for outcome $-$. (Hint: Using Exercise 2.6 from Assignment 1 might help (not necessary though).) (8 points)

          Answer: $M_0=\ket{0}\bra{0}$

          Observe $\ket{0}$ with probability $p_0=Tr(M_0\rho)=Tr(\ket{0}\bra{0}\otimes I\rho)=Tr(\ket{0}\bra{0}\otimes I\ket{\Phi^{-}}\bra{\Phi^{-}})=\braket{0|0}\bra{0}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{0}\otimes I+\braket{1|0}\bra{0}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{1}\otimes I=\bra{0}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{0}\otimes I$

          $\rho_0'=\frac{M_0\rho M_0^{\dagger}}{Tr(M_0\rho)}
              \\=\frac{\ket{0}\bra{0}\otimes I\ket{\Phi^{-}}\bra{\Phi^{-}}\ket{0}\bra{0}\otimes I}{\bra{0}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{0}\otimes I}
              \\=\ket{00}\bra{00}
              \\=\ket{0}\bra{0}\otimes\ket{0}\bra{0}
          $

          For system B, $\rho_{0B}'=\ket{0}\bra{0}$


          $M_1=\ket{-}\bra{-}$

          Observe $\ket{-}$ with probability $p_1=Tr(M_1\rho)=Tr(\ket{-}\bra{-}\otimes I\rho)=Tr(\ket{-}\bra{-}\otimes I\ket{\Phi^{-}}\bra{\Phi^{-}})=\braket{+|-}\bra{-}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{+}\otimes I+\braket{-|-}\bra{-}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{-}\otimes I=\bra{+}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{+}\otimes I$

          $\rho_1'=\frac{M_1\rho M_1^{\dagger}}{Tr(M_1\rho)}
              \\=\frac{\ket{-}\bra{-}\otimes I\ket{\Phi^{-}}\bra{\Phi^{-}}\ket{-}\bra{-}\otimes I}{\bra{+}\otimes I\ket{\Phi^-}\bra{\Phi^-}\ket{+}\otimes I}
              \\=\ket{--}\bra{--}
              \\=\ket{-}\bra{-}\otimes\ket{-}\bra{-}
          $

          For system B, $\rho_{1B}'=\ket{-}\bra{-}$

    \item What is the post measurement state if the measurements above were destructive and yielded the same outcomes as in part 1.? (2 points)

          Answer:

          For the outcome 0, $\rho_0''=Tr(\rho_{0B}')=Tr(\ket{0}\bra{0})=1$


          For the outcome -, $\rho_1''=Tr(\rho_{1B}')=Tr(\ket{-}\bra{-})=1$

    \item What is the reduced state $\rho_A$ if we take state $\rho_{AB}$ and trace over system B in basis $\{\ket{0}, \ket{1}\}$? What if we trace in $\{\ket{+}, \ket{-}\}$? Hint: for the second computation it could be useful to use the basis invariance of the trace operation. (6 points)

          Answer: $\rho_{AB}=\ket{\Phi^-}\bra{\Phi^-}=\frac{1}{2}(\ket{01}-\ket{10})(\bra{01}-\bra{10})
              =\frac{1}{2}(\ket{01}\bra{01}-\ket{01}\bra{10}-\ket{10}\bra{01}+\ket{10}\bra{10})
          $


          $\rho_A=Tr_B(\rho_{AB})=\frac{1}{2}(\bra{0}\otimes\bra{0}\rho_{AB}\ket{0}\otimes\ket{0}+\bra{1}\otimes\bra{1}\rho_{AB}\ket{1}\otimes{1})
              \\=\frac{1}{2}(\bra{0}\otimes\bra{0}(\ket{01}\bra{01}-\ket{01}\bra{10}-\ket{10}\bra{01}+\ket{10}\bra{10})\ket{0}\otimes\ket{0}+\bra{1}\otimes\bra{1}(\ket{01}\bra{01}-\ket{01}\bra{10}-\ket{10}\bra{01}+\ket{10}\bra{10})\ket{1}\otimes\ket{1})
              \\=\frac{1}{2}(\ket{0}\bra{0}+\ket{1}\bra{1})
          $


          In the basis $\{\ket{+},\ket{-}\}$, $\Phi=\frac{1}{2}(\ket{+}\otimes\ket{-}-\ket{-}\otimes\ket{+})$

          $\rho_A=Tr_B
          $

    \item Consider now the $2n$-qubit state $\rho = |\Psi_n\rangle\langle\Psi_n|$, with $|\Psi_n\rangle = \frac{1}{\sqrt{2^n}}\sum_{i=0}^{2^n-1} |i\rangle_A \otimes |i\rangle_B$. What is the reduced $n$-qubit state on Alice's side? (Hint: look at the state in vector form and factorize it in a smart way.) (8 points)

\end{enumerate}

\end{document}
